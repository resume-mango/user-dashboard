{"version":3,"file":"922.bundle.js","mappings":"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","sources":["webpack://user-dashboard/./src/helpers/axiosRequest.ts","webpack://user-dashboard/./src/hooks/getQueryAdvance.ts","webpack://user-dashboard/./src/hooks/getUrlParams.ts","webpack://user-dashboard/./src/pages/404.tsx","webpack://user-dashboard/./src/apis/subscribe.ts","webpack://user-dashboard/./src/pages/subscribe/callback.tsx","webpack://user-dashboard/./src/pages/subscribe/main.tsx","webpack://user-dashboard/./src/pages/subscribe/index.tsx","webpack://user-dashboard/./src/public/logo/resume-mango-full-logo.png"],"sourcesContent":["import axios, { AxiosResponse } from 'axios'\n/**\n * Axios api request helper\n * @param options axios request options\n * @returns data | error\n */\nconst axiosRequest = async (\n  options: any\n): Promise<{ data: any; error: any }> => {\n  let data: any = ''\n  let error: any = ''\n  try {\n    const { data: res }: AxiosResponse<any> = await axios.request(options)\n    data = res || ''\n  } catch (err: any) {\n    error =\n      (err.response && err.response.data && err.response.data.error.message) ||\n      'Something went wrong!'\n  }\n\n  return { data, error }\n}\n\nexport default axiosRequest\n","import { useQuery, UseQueryOptions } from 'react-query'\nimport { useAuth } from '../contexts/authProvider'\n\n/**\n * Advance hook for useQuery()\n * @param identifier queryKey  identifier\n * @param fetcher queryFn()\n * @param enabled should query be enabled?\n * @param params useQuery() options\n * @returns useQuery()\n */\nconst getQueryAdvance = (\n  identifier: any,\n  fetcher: () => any,\n  enabled = true,\n  params?: Omit<\n    UseQueryOptions<any, unknown, any, any>,\n    'queryKey' | 'queryFn' | 'enabled'\n  >\n) => {\n  const { user, token } = useAuth()\n  const ref = user && user.ref\n\n  return useQuery(identifier, fetcher, {\n    enabled: !!token && !!ref && enabled,\n    ...params,\n  })\n}\n\nexport default getQueryAdvance\n","/* istanbul ignore file */\n\nimport React from 'react'\nimport { useLocation } from 'react-router-dom'\n/**\n * decode parameters form url\n * @returns memoized URLSearchParams\n */\nconst getUrlParams = () => {\n  const { search } = useLocation()\n\n  return React.useMemo(() => new URLSearchParams(search), [search])\n}\n\nexport default getUrlParams\n","import React from 'react'\n\nconst PageNotFound = () => {\n  return (\n    <div className='align-center'>\n      <div>\n        <h3 className='text-center'>This page could not be found</h3>\n      </div>\n    </div>\n  )\n}\n\nexport default PageNotFound\n","import axiosRequest from '../helpers/axiosRequest'\n\n/**\n *\n * @param planId string\n * @returns checkout url\n */\nexport const apiCreateSubscription = async (planId: string) => {\n  let data\n  let error: string\n\n  const options = {\n    method: 'POST',\n    url: `/subscribe/${planId}`,\n  }\n\n  try {\n    const res = await axiosRequest(options)\n    data = res.data as any\n    error = res.error\n    return { data, error }\n  } catch (err: any) {\n    return { data: undefined, error: err }\n  }\n}\n\n/**\n *\n * @param planId string\n * @returns checkout url\n */\nexport const apiUpgradeSubscription = async (planId: string) => {\n  let data\n  let error: string\n\n  const options = {\n    method: 'PATCH',\n    url: `/subscription/upgrade/${planId}`,\n  }\n\n  try {\n    const res = await axiosRequest(options)\n    data = res.data as any\n    error = res.error\n    return { data, error }\n  } catch (err: any) {\n    return { data: undefined, error: err }\n  }\n}\n\n/**\n *\n * @param id Stripe Session Id or Paypal subscription Id\n * @param type success | cancel\n * @returns\n */\nexport const apiCallbackSubscription = async (\n  id: string,\n  type: 'success' | 'cancel'\n) => {\n  let data\n  let error: string\n\n  const options = {\n    method: 'GET',\n    url: `/subscribe/cb?id=${id}&type=${type}`,\n  }\n\n  try {\n    const res = await axiosRequest(options)\n    data = res.data as any\n    error = res.error\n    return { data, error }\n  } catch (err: any) {\n    return { data: undefined, error: err }\n  }\n}\n","import React, { Fragment, useEffect, useState } from 'react'\nimport { useQueryClient } from 'react-query'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\nimport { apiCallbackSubscription } from '../../apis/subscribe'\nimport WarningIcon from '../../components/svgs/warning'\nimport { useAuth } from '../../contexts/authProvider'\nimport getUrlParams from '../../hooks/getUrlParams'\nimport { Button } from '../../styled/button'\nimport { LoadingDots, LoadingWrapper, Spinner } from '../../styled/loader'\n\nconst SubscribeCallback = () => {\n  const [error, setError] = useState(false)\n  const { setToken } = useAuth()\n  const history = useHistory()\n  const query = getUrlParams()\n  const session_id = query.get('session_id')\n  const type = query.get('type') as any\n  const queryClient = useQueryClient()\n\n  const handleCallback = async () => {\n    if (session_id && type) {\n      const { data, error } = await apiCallbackSubscription(session_id, type)\n      if (data && !error) {\n        queryClient.setQueryData('activeSubscription', data)\n        setToken('')\n        history.push('/my-account/membership')\n      } else {\n        setError(true)\n      }\n    }\n  }\n\n  useEffect(() => {\n    if (type === 'cancel' || type === 'success') handleCallback()\n    return\n  }, [])\n\n  return (\n    <Fragment>\n      {error ? (\n        <Wrapper>\n          <Container>\n            <WarningIcon size=\"7rem\" color=\"#f08438\" className=\"mb-2\" />\n            <h1>Error!</h1>\n            <p className=\"mb-2\"> Something went wrong...</p>\n            <Button\n              size=\"lg\"\n              btnType=\"secondary\"\n              onClick={() => history.push('/')}\n            >\n              Back to Dashboard\n            </Button>\n          </Container>\n        </Wrapper>\n      ) : (\n        <LoadingWrapper>\n          <Spinner type=\"primary\" size=\"2rem\" />\n          <LoadingDots color=\"#f08438\">Redirecting</LoadingDots>\n        </LoadingWrapper>\n      )}\n    </Fragment>\n  )\n}\n\nexport default SubscribeCallback\n\nconst Wrapper = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100vh;\n`\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  padding: 2rem;\n  width: 400px;\n  min-height: 400px;\n  margin: auto;\n  border-radius: 6px;\n  border: 1px solid #e7e7e7;\n  h1 {\n    margin-bottom: 0;\n  }\n  p {\n    font-size: 1rem;\n    max-width: 350px;\n  }\n  button {\n    font-size: 1rem;\n    width: 200px;\n  }\n`\n","import React, { Fragment, useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport Logo from '../../public/logo/resume-mango-full-logo.png'\nimport CheckCircle from '../../public/images/check-filled.svg'\nimport ItemsInBox from '../../public/images/items-in-box.png'\nimport { Spinner } from '../../styled/loader'\nimport Alert from '../../components/ui/alert'\nimport { NavLink, useHistory } from 'react-router-dom'\nimport { useViewport } from '../../contexts/viewPort'\nimport {\n  apiCreateSubscription,\n  apiUpgradeSubscription,\n} from '../../apis/subscribe'\nimport { useNotify } from '../../contexts/notify'\nimport CrossIcon from '../../components/svgs/cross'\nimport getQueryAdvance from '../../hooks/getQueryAdvance'\nimport axios from 'axios'\nimport { useQueryClient } from 'react-query'\nimport { useAuth } from '../../contexts/authProvider'\n\nconst MainSubscribe = () => {\n  const [plan, setPlan] = useState('')\n  const [loadingApi, setLoadingApi] = useState(false)\n  const [upgraded, setUpgraded] = useState(false)\n  const [alreadyOnPremium, setAlreadyOnPremium] = useState(false)\n  const [options, setOptions] = useState([])\n  const { setNotify } = useNotify()\n  const { setToken } = useAuth()\n  const fetcher = async () => {\n    const { data } = await axios.get(`/subscribe`)\n    return data\n  }\n\n  const queryClient = useQueryClient()\n\n  const { width } = useViewport()\n\n  const history = useHistory()\n\n  const { data, isError, isLoading }: any = getQueryAdvance(\n    'subscribe',\n    () => fetcher(),\n    true,\n    {\n      staleTime: 0,\n      cacheTime: 0,\n      onError(err: any) {\n        if (err && err.response && err.response.status === 409) {\n          setAlreadyOnPremium(true)\n        }\n      },\n    }\n  )\n\n  useEffect(() => {\n    if (!data || !data.plans) return\n    setPlan(data.plans[0]._id)\n  }, [data])\n\n  // Set plan options\n  useEffect(() => {\n    if (!plan) return\n    const item = data.plans.filter(\n      (val: Record<string, any>) => val._id === plan\n    )[0]\n    if (!item) return\n\n    setOptions(item.highlights)\n  }, [plan])\n\n  const handleCheckout = async () => {\n    if (loadingApi) return\n\n    setLoadingApi(true)\n    const { data, error } = await apiCreateSubscription(plan)\n    if (!data || error) {\n      setNotify({\n        type: 'danger',\n        heading: 'Err',\n        message: 'Something went wrong!',\n      })\n      setLoadingApi(false)\n    } else {\n      window.location.replace(data)\n    }\n  }\n\n  useEffect(() => {\n    if (!upgraded) return\n    const timer = setTimeout(() => {\n      history.replace('/my-account/membership')\n    }, 3000)\n    return () => clearTimeout(timer)\n  }, [upgraded])\n\n  const handleUpgrade = async () => {\n    if (loadingApi || upgraded) return\n    setLoadingApi(true)\n    const { data, error } = await apiUpgradeSubscription(plan)\n    if (!data || error) {\n      setNotify({\n        type: 'danger',\n        heading: 'Err',\n        message: 'Failed to upgrade plan!',\n      })\n      setLoadingApi(false)\n    } else {\n      setToken('')\n      setLoadingApi(false)\n      setUpgraded(true)\n      queryClient.setQueryData('activeSubscription', data)\n      return true\n    }\n  }\n\n  return (\n    <Fragment>\n      {isLoading && !data ? (\n        <div className=\"align-center\">\n          <Spinner size=\"40px\" type=\"primary\" />\n        </div>\n      ) : isError ? (\n        <Fragment>\n          {alreadyOnPremium ? (\n            <Alert\n              show={true}\n              type=\"warning\"\n              message=\"You are already on premium membership\"\n            />\n          ) : (\n            <Alert\n              show={true}\n              type=\"warning\"\n              heading=\"Oops\"\n              message=\"Failed to fetch plans from server.\"\n            />\n          )}\n        </Fragment>\n      ) : (\n        <Main>\n          {width > 1000 && (\n            <LHSWrapper>\n              <img\n                src={Logo}\n                alt=\"resume-mango logo\"\n                width=\"200px\"\n                style={{ margin: '1.5rem' }}\n              />\n\n              <Section>\n                <h1> Upgrade your plan to unlock these features</h1>\n                <PlansWrapper>\n                  <div>\n                    <ul>\n                      {options.map(\n                        (option: { key: string; bool: boolean }, i: number) => (\n                          <li key={i}>\n                            {option.bool ? (\n                              <img src={CheckCircle} alt=\"check circle\" />\n                            ) : (\n                              <CrossCircle>\n                                <CrossIcon size=\"0.5rem\" />\n                              </CrossCircle>\n                            )}\n\n                            {option.key}\n                          </li>\n                        )\n                      )}\n                    </ul>\n                  </div>\n\n                  <div>\n                    <img\n                      src={ItemsInBox}\n                      alt=\"putting items in basket\"\n                      width=\"100%\"\n                    />\n                  </div>\n                </PlansWrapper>\n              </Section>\n            </LHSWrapper>\n          )}\n          <RHSWrapper>\n            <div className=\"rhs-section\">\n              {width < 1000 && (\n                <img\n                  src={Logo}\n                  alt=\"resume-mango logo\"\n                  width=\"200px\"\n                  style={{ margin: '.5rem' }}\n                />\n              )}\n              <NavLink to=\"/\">\n                <CloseWrapper>\n                  <CrossIcon size=\"1.3rem\" />\n                </CloseWrapper>\n              </NavLink>\n            </div>\n            <Section>\n              {width < 1000 && (\n                <MobileImg>\n                  <img\n                    src={ItemsInBox}\n                    alt=\"putting items in basket\"\n                    width=\"100%\"\n                  />\n                </MobileImg>\n              )}\n              {/* <h2>\n                Your resume is ready. Enter your payment details to download the\n                resume\n              </h2> */}\n              <h3>\n                {data.subscription_type === 'new'\n                  ? 'Select Plan'\n                  : 'Upgrade Plan'}\n              </h3>\n              {data?.plans.map((item: any, i: number) => (\n                <PlanSelect key={i} onClick={() => setPlan(item._id)}>\n                  <div>\n                    <Circle checked={plan === item._id} />\n                    <p>\n                      <b>{item.name}&nbsp;Plan</b>\n                    </p>\n                  </div>\n                  <div>\n                    <p>\n                      <b>${item.price} </b>/{' '}\n                      {item.type === 'pro'\n                        ? `${item.interval_count * 24} Hrs`\n                        : item.interval}\n                    </p>\n                  </div>\n                </PlanSelect>\n              ))}\n              {data.invoice &&\n                data.invoice.data &&\n                data.invoice.data.length > 0 && (\n                  <InvoiceWrapper>\n                    <div className=\"item\">\n                      <p className=\"label\">Description</p>\n                      <p className=\"label end\">Amount</p>\n                    </div>\n                    {data.invoice.data.map((item: any, i: number) => (\n                      <div className=\"item\" key={i}>\n                        <p>{item.description}</p>\n                        <p\n                          className={`amount ${item.amount < 0 && 'negative'}`}\n                        >\n                          ${Math.abs(item.amount)}\n                        </p>\n                      </div>\n                    ))}\n                    <div className=\"item\">\n                      <p className=\"total\">NEXT INVOICE</p>\n                      <p\n                        className={`total amount ${\n                          data.invoice.total < 0 && 'negative'\n                        }`}\n                      >\n                        ${data.invoice.total}&nbsp;\n                        {data.invoice.currency && data.invoice.currency}\n                      </p>\n                    </div>\n                  </InvoiceWrapper>\n                )}\n              {data.subscription_type === 'new' ? (\n                <CheckoutBtn\n                  disabled={loadingApi}\n                  onClick={() => handleCheckout()}\n                  background=\"#343434\"\n                  hoverBackground=\"#202020\"\n                >\n                  {loadingApi ? (\n                    <Fragment>\n                      Processing\n                      <Spinner size=\"1.3rem\" style={{ marginLeft: '1rem' }} />\n                    </Fragment>\n                  ) : (\n                    'Proceed to Checkout'\n                  )}\n                </CheckoutBtn>\n              ) : data.subscription_type === 'exists' ? (\n                <CheckoutBtn\n                  onClick={() => handleUpgrade()}\n                  // onClick={() => setUpgraded(!upgraded)}\n                  background={upgraded ? '#26bf7b' : '#343434'}\n                  hoverBackground={upgraded ? '#26bf7b' : '#202020'}\n                >\n                  {upgraded ? (\n                    <Fragment>\n                      Upgraded\n                      <SuccessTickMark>\n                        <svg\n                          className=\"checkmark\"\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                          viewBox=\"0 0 52 52\"\n                        >\n                          <circle\n                            className=\"checkmark__circle\"\n                            cx=\"26\"\n                            cy=\"26\"\n                            r=\"25\"\n                            fill=\"none\"\n                          />\n                          <path\n                            className=\"checkmark__check\"\n                            fill=\"none\"\n                            d=\"M14.1 27.2l7.1 7.2 16.7-16.8\"\n                          />\n                        </svg>\n                      </SuccessTickMark>\n                    </Fragment>\n                  ) : loadingApi ? (\n                    <Fragment>\n                      Upgrading\n                      <Spinner size=\"1.3rem\" style={{ marginLeft: '1rem' }} />\n                    </Fragment>\n                  ) : (\n                    'Upgrade Plan '\n                  )}\n                </CheckoutBtn>\n              ) : null}\n            </Section>\n          </RHSWrapper>\n        </Main>\n      )}\n    </Fragment>\n  )\n}\n\nexport default MainSubscribe\n\nconst SuccessTickMark = styled.div`\n  .checkmark {\n    width: 25px;\n    height: 25px;\n    border-radius: 50%;\n    display: block;\n    stroke-width: 4;\n    stroke: #fff;\n    stroke-miterlimit: 10;\n    box-shadow: inset 0px 0px 0px #26bf7b;\n    animation: fill 0.4s ease-in-out 0.4s forwards,\n      scale 0.3s ease-in-out 0.9s both;\n    margin-left: 1rem;\n  }\n  .checkmark__circle {\n    stroke-dasharray: 166;\n    stroke-dashoffset: 166;\n    stroke-width: 4;\n    stroke-miterlimit: 10;\n    stroke: #fff;\n    fill: #26bf7b;\n    animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;\n  }\n\n  .checkmark__check {\n    transform-origin: 50% 50%;\n    stroke-dasharray: 48;\n    stroke-dashoffset: 48;\n    animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;\n  }\n\n  @keyframes stroke {\n    100% {\n      stroke-dashoffset: 0;\n    }\n  }\n\n  @keyframes scale {\n    0%,\n    100% {\n      transform: none;\n    }\n\n    50% {\n      transform: scale3d(1.1, 1.1, 1);\n    }\n  }\n\n  @keyframes fill {\n    100% {\n      box-shadow: inset 0px 0px 0px 30px #4bb71b;\n    }\n  }\n`\n\nconst InvoiceWrapper = styled.div`\n  border-radius: 7px;\n  box-shadow: 5px 5px 10px 5px rgb(237 237 237 / 50%);\n  border: 1px solid rgb(237 237 237 / 40%);\n  padding: 1rem;\n  .item {\n    display: grid;\n    grid-template-columns: 80% 20%;\n    width: 100%;\n    &:not(:last-child) {\n      border-bottom: 1px solid #eee;\n    }\n    p {\n      font-size: 0.8rem;\n    }\n    .end {\n      text-align: end;\n    }\n    .label {\n      font-weight: 600;\n      font-size: 0.7rem;\n      text-transform: uppercase;\n    }\n\n    .amount {\n      font-weight: 600;\n      text-align: end;\n\n      color: #888;\n\n      letter-spacing: 1.5px;\n    }\n    .negative:before {\n      content: '-';\n    }\n    .total {\n      font-weight: 600;\n      color: #343434;\n    }\n  }\n`\n\nconst Main = styled.main`\n  display: grid;\n  grid-template-columns: 60% 40%;\n  width: 100%;\n  height: 100%;\n`\nconst LHSWrapper = styled.div`\n  height: 100%;\n  background-color: #f7f7f7;\n`\n\nconst RHSWrapper = styled.div`\n  height: 100%;\n  .rhs-section {\n    padding-bottom: 2rem;\n    &:first-child {\n      display: flex;\n      justify-content: flex-end;\n    }\n  }\n  @media (max-width: 1000px) {\n    width: 100%;\n    .rhs-section {\n      &:first-child {\n        justify-content: space-between;\n        align-items: center;\n      }\n    }\n  }\n`\n\nconst Section = styled.div`\n  padding-bottom: 4rem;\n  width: 80%;\n  margin: auto;\n  h1 {\n    max-width: 567px;\n  }\n  h2 {\n    font-size: 1.5rem;\n  }\n  h1,\n  h2 {\n    margin-bottom: 2rem;\n  }\n  @media (max-width: 1000px) {\n    width: 95%;\n    h2 {\n      font-size: 1.2rem;\n    }\n  }\n`\n\nconst PlansWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  max-width: 800px;\n\n  ul {\n    margin-bottom: 2.3rem;\n    li {\n      display: flex;\n      font-size: 1rem;\n      padding: 0.5rem 0;\n      img {\n        margin-right: 15px;\n      }\n    }\n  }\n`\n\nconst PlanSelect = styled.div`\n  user-select: none;\n  width: 100%;\n  height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-radius: 7px;\n  box-shadow: 5px 5px 10px 5px rgb(237 237 237 / 50%);\n  border: 1px solid rgb(237 237 237 / 40%);\n  padding: 1.5rem;\n  cursor: pointer;\n  margin-bottom: 1.5rem;\n  div {\n    display: flex;\n    align-items: center;\n  }\n  p {\n    text-transform: capitalize;\n    margin: 0;\n  }\n`\nconst Circle = styled.div<{ checked: boolean }>`\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n  margin-right: 1.5rem;\n  border: 3px solid #fff;\n  outline: 2px solid\n    ${({ checked }) => (checked ? 'rgba(240, 132, 56, 1)' : '#ddd')};\n  background-color: ${({ checked }) =>\n    checked ? 'rgba(240, 132, 56, 1)' : '#fff'};\n`\nconst PayBtn = styled.div`\n  width: 100%;\n  height: 50px;\n  margin-top: 1rem;\n`\nconst MobileImg = styled.div`\n  max-width: 480px;\n  padding: 2rem;\n  margin: auto;\n`\nconst CheckoutBtn = styled.button<{\n  background: string\n  hoverBackground: string\n}>`\n  width: 100%;\n  height: 50px;\n  margin-top: 1.5rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: ${({ background }) => background};\n  color: #fff;\n  border-radius: 6px;\n  font-size: 1rem;\n  &:disabled {\n    background-color: ${({ background }) => background};\n    opacity: 0.5;\n  }\n  &:hover {\n    background-color: ${({ hoverBackground }) => hoverBackground};\n  }\n  img {\n    height: auto;\n    width: 70px;\n  }\n`\nconst CrossCircle = styled.span`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  background-color: ${({ theme }) => theme.shades.danger};\n  border-radius: 50%;\n  margin-right: 15px;\n  svg {\n    path {\n      stroke: ${({ theme }) => theme.colors.danger};\n    }\n  }\n`\nconst CloseWrapper = styled.div`\n  width: 30px;\n  height: 30px;\n  margin: 1.5rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &:hover {\n    svg {\n      path {\n        stroke: ${({ theme }) => theme.colors.primary};\n      }\n    }\n  }\n`\n","import React, { Fragment } from 'react'\nimport { Route, Switch, useRouteMatch } from 'react-router-dom'\nimport PageNotFound from '../404'\nimport SubscribeCallback from './callback'\nimport MainSubscribe from './main'\n\nconst Subscribe = () => {\n  const { path } = useRouteMatch()\n\n  return (\n    <Fragment>\n      <Switch>\n        <Route exact path={path} component={MainSubscribe} />\n        <Route path={`${path}/callback`} component={SubscribeCallback} />\n        <Route component={PageNotFound} />\n      </Switch>\n    </Fragment>\n  )\n}\n\nexport default Subscribe\n","export default __webpack_public_path__ + \"images/resume-mango-full-logo.png\";"],"names":["options","data","error","axios","res","response","message","identifier","fetcher","enabled","params","useAuth","user","token","ref","useQuery","search","useLocation","React","URLSearchParams","className","apiCreateSubscription","planId","method","url","axiosRequest","undefined","apiUpgradeSubscription","apiCallbackSubscription","id","type","useState","setError","setToken","history","useHistory","query","getUrlParams","session_id","get","queryClient","useQueryClient","handleCallback","setQueryData","push","useEffect","Fragment","Wrapper","Container","size","color","btnType","onClick","styled","plan","setPlan","loadingApi","setLoadingApi","upgraded","setUpgraded","alreadyOnPremium","setAlreadyOnPremium","setOptions","setNotify","useNotify","width","useViewport","getQueryAdvance","staleTime","cacheTime","onError","err","status","isError","isLoading","plans","_id","item","filter","val","highlights","handleCheckout","heading","window","location","replace","timer","setTimeout","clearTimeout","handleUpgrade","show","Main","LHSWrapper","src","Logo","alt","style","margin","Section","PlansWrapper","map","option","i","bool","CheckCircle","CrossCircle","key","ItemsInBox","RHSWrapper","to","CloseWrapper","MobileImg","subscription_type","PlanSelect","Circle","checked","name","price","interval_count","interval","invoice","length","InvoiceWrapper","description","amount","Math","abs","total","currency","CheckoutBtn","disabled","background","hoverBackground","marginLeft","SuccessTickMark","xmlns","viewBox","cx","cy","r","fill","d","theme","shades","danger","colors","primary","path","useRouteMatch","exact","component","MainSubscribe","SubscribeCallback","PageNotFound"],"sourceRoot":""}